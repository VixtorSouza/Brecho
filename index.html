!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
  <title>Brechó Mobile</title>
  <style>
    :root{
      --bg:#0f172a; /* slate-900 */
      --card:#111827; /* gray-900 */
      --muted:#1f2937; /* gray-800 */
      --text:#e5e7eb; /* gray-200 */
      --soft:#94a3b8; /* slate-400 */
      --brand:#22c55e; /* green-500 */
      --danger:#ef4444; /* red-500 */
      --ok:#3b82f6; /* blue-500 */
      --radius:18px;
      --shadow:0 10px 25px rgba(0,0,0,.35);
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0; background:linear-gradient(180deg,#0b1224,#0f172a 35%,#0b1224); color:var(--text);
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
    }
    .container{max-width:900px;margin:0 auto;padding:16px}
    .card{background:var(--card); border:1px solid #1f2937; border-radius:var(--radius); box-shadow:var(--shadow)}
    .p-16{padding:16px}
    .p-20{padding:20px}
    .mb-12{margin-bottom:12px}
    .mb-16{margin-bottom:16px}
    .mb-24{margin-bottom:24px}
    .grid{display:grid; gap:12px}
    .grid-2{grid-template-columns:repeat(2,1fr)}
    .grid-3{grid-template-columns:repeat(3,1fr)}
    @media (max-width:720px){
      .grid-2,.grid-3{grid-template-columns:1fr}
      .container{padding:12px}
    }

    h1{font-size:22px; margin:0 0 8px}
    h2{font-size:18px; margin:0 0 8px; color:#f8fafc}
    .muted{color:var(--soft); font-size:14px}

    input,select,button,textarea{
      width:100%; padding:12px 14px; border-radius:14px; border:1px solid #253248; background:#0b1327; color:var(--text);
      outline:none;
    }
    input::placeholder{color:#93a0b8}
    button{cursor:pointer; border:none; transition:.2s transform ease, .2s opacity ease}
    button:active{transform:scale(.98)}
    .btn{background:var(--brand); color:#052e13; font-weight:700}
    .btn.secondary{background:var(--ok); color:#05142a}
    .btn.ghost{background:#0b1327}
    .btn.danger{background:var(--danger); color:#2b0b0b}

    .topbar{
      position:sticky; top:0; z-index:20; backdrop-filter:saturate(120%) blur(10px);
      background:rgba(2,6,23,.6); border-bottom:1px solid #1f2937;
    }
    .topbar-inner{display:flex; align-items:center; gap:10px; padding:12px 16px}
    .logo{display:flex; align-items:center; gap:10px}
    .logo-badge{width:36px;height:36px;border-radius:12px;background:linear-gradient(135deg,#22c55e,#16a34a); display:grid; place-items:center; font-weight:900; color:#052e13}
    .grow{flex:1}
    .tabs{display:flex; gap:8px}

    .hide{display:none !important}

    /* Lista & cards */
    .catalog{display:grid; gap:12px; grid-template-columns:repeat(auto-fill,minmax(160px,1fr))}
    .prod-card{border:1px solid #1f2937; border-radius:16px; overflow:hidden; background:linear-gradient(180deg,#0b1327,#0f172a)}
    .thumb{aspect-ratio:1/1; width:100%; background:#0b1327; object-fit:cover}
    .prod-body{padding:10px}
    .prod-title{font-weight:700; font-size:14px}
    .badge{display:inline-flex; padding:4px 8px; border-radius:999px; border:1px solid #2a3a57; font-size:11px; color:#cbd5e1}

    /* Tabela simples */
    table{width:100%; border-collapse:collapse; font-size:14px}
    th,td{padding:10px; border-bottom:1px solid #1f2937; text-align:left}
    tr.low td{background:rgba(245,158,11,.08)}
    .actions{display:flex; gap:8px}

    .pill{display:inline-flex; gap:8px; align-items:center; padding:8px 10px; border:1px solid #1f2937; border-radius:999px}

    .footer{padding:30px 16px; text-align:center; color:#94a3b8}
  </style>
</head>
<body>
  <header class="topbar card">
    <div class="topbar-inner container">
      <div class="logo">
        <div class="logo-badge">B</div>
        <div>
          <div style="font-weight:800">Brechó Mobile</div>
          <div class="muted" id="sessionRole">Sem sessão</div>
        </div>
      </div>
      <div class="grow"></div>
      <div class="tabs">
        <button class="btn ghost" id="tabCatalog">Catálogo</button>
        <button class="btn ghost" id="tabEstoque">Estoque</button>
        <button class="btn ghost" id="tabCadastro">Cadastrar</button>
        <button class="btn secondary" id="tabConta">Conta</button>
      </div>
    </div>
  </header>

  <main class="container">
    <!-- LOGIN / CONTA -->
    <section id="viewAuth" class="card p-20 mb-16">
      <h1>Entrar</h1>
      <p class="muted mb-16">Acesse como <b>Pessoa</b> (cliente) ou <b>Administrador</b>. Os dados ficam apenas no seu dispositivo (localStorage).</p>
      <div class="grid grid-2">
        <div class="card p-16">
          <h2>Pessoa</h2>
          <div class="mb-12">
            <label class="muted">Seu nome</label>
            <input id="cliNome" placeholder="Ex.: Ana" />
          </div>
          <div class="mb-12">
            <label class="muted">E-mail</label>
            <input id="cliEmail" placeholder="ana@email.com" type="email" />
          </div>
          <button class="btn" id="btnLoginPessoa">Entrar como Pessoa</button>
        </div>
        <div class="card p-16">
          <h2>Administrador</h2>
          <div class="mb-12">
            <label class="muted">E-mail</label>
            <input id="admEmail" placeholder="admin@brecho.com" value="admin@brecho.com" />
          </div>
          <div class="mb-12">
            <label class="muted">Senha</label>
            <input id="admSenha" placeholder="••••••" type="password" value="123456" />
          </div>
          <button class="btn" id="btnLoginAdmin">Entrar como Admin</button>
          <p class="muted" style="margin-top:8px">Padrão: <code>admin@brecho.com</code> / <code>123456</code></p>
        </div>
      </div>
    </section>

    <!-- CATÁLOGO (visível a todos) -->
    <section id="viewCatalog" class="card p-20 mb-16">
      <div class="grid">
        <div class="grid grid-2">
          <div>
            <h1>Catálogo</h1>
            <p class="muted">Veja os produtos disponíveis. Pessoas não conseguem editar; administradores podem gerenciar estoque.</p>
          </div>
          <div class="pill">
            <input id="search" placeholder="Buscar por nome ou categoria..." />
            <select id="filtroCond">
              <option value="">Condição</option>
              <option>Novo</option>
              <option>Semi-novo</option>
              <option>Usado</option>
            </select>
          </div>
        </div>
        <div id="catalogList" class="catalog"></div>
      </div>
    </section>

    <!-- ESTOQUE (apenas admin) -->
    <section id="viewEstoque" class="card p-20 mb-16 hide">
      <div class="grid">
        <div class="grid grid-2">
          <div>
            <h1>Estoque</h1>
            <p class="muted">Visualize, edite quantidade e remova itens. Linhas em amarelo estão com estoque baixo.</p>
          </div>
          <div class="grid grid-2">
            <div class="pill"><span>Total de itens:</span> <b id="totItens">0</b></div>
            <div class="pill"><span>Unidades em estoque:</span> <b id="totUnidades">0</b></div>
          </div>
        </div>
        <div class="card p-16">
          <div style="overflow:auto">
            <table>
              <thead>
                <tr>
                  <th>Produto</th>
                  <th>Categoria</th>
                  <th>Tam.</th>
                  <th>Condição</th>
                  <th>Preço (R$)</th>
                  <th>Qtd</th>
                  <th>Ações</th>
                </tr>
              </thead>
              <tbody id="estoqueBody"></tbody>
            </table>
          </div>
        </div>
      </div>
    </section>

    <!-- CADASTRO (apenas admin) -->
    <section id="viewCadastro" class="card p-20 mb-16 hide">
      <h1>Cadastrar Produto</h1>
      <p class="muted mb-16">Preencha os campos para adicionar um item ao estoque.</p>
      <div class="grid grid-3">
        <div>
          <label class="muted">Nome</label>
          <input id="pNome" placeholder="Ex.: Camisa vintage" />
        </div>
        <div>
          <label class="muted">Categoria</label>
          <input id="pCat" placeholder="Ex.: Camisas" />
        </div>
        <div>
          <label class="muted">Tamanho</label>
          <input id="pTam" placeholder="P / M / G / 40 / Único" />
        </div>
        <div>
          <label class="muted">Condição</label>
          <select id="pCond">
            <option value="Novo">Novo</option>
            <option value="Semi-novo">Semi-novo</option>
            <option value="Usado">Usado</option>
          </select>
        </div>
        <div>
          <label class="muted">Preço (R$)</label>
          <input id="pPreco" type="number" min="0" step="0.01" placeholder="0,00" />
        </div>
        <div>
          <label class="muted">Quantidade</label>
          <input id="pQtd" type="number" min="0" step="1" placeholder="0" />
        </div>
        <div class="grid" style="grid-column:1/-1">
          <label class="muted">Imagem (URL – opcional)</label>
          <input id="pImg" placeholder="https://..." />
        </div>
      </div>
      <div class="grid grid-2" style="margin-top:12px">
        <button class="btn" id="btnSalvarProduto">Salvar Produto</button>
        <button class="btn ghost" id="btnLimparForm">Limpar</button>
      </div>
    </section>

    <section class="footer muted">
      Feito com ♥️ para seu brechó. Os dados ficam no seu navegador.
    </section>
  </main>

  <script>
    // ====== Helpers ======
    const uuid = () => (crypto && crypto.randomUUID) ? crypto.randomUUID() : 'id-' + Math.random().toString(36).slice(2) + Date.now();
    const $ = sel => document.querySelector(sel);
    const $$ = sel => Array.from(document.querySelectorAll(sel));
    const fmt = n => Number(n||0).toLocaleString('pt-BR', {minimumFractionDigits:2, maximumFractionDigits:2});

    // ====== Armazenamento ======
    const LS_PROD = 'brecho_products_v1';
    const LS_SESS = 'brecho_session_v1';

    /** @type {Array<{id:string,nome:string,cat:string,tam:string,cond:string,preco:number,qtd:number,img?:string}>} */
    let produtos = [];
    let session = null;

    try { produtos = JSON.parse(localStorage.getItem(LS_PROD) || '[]') } catch(_) { produtos = [] }
    try { session = JSON.parse(localStorage.getItem(LS_SESS) || 'null') } catch(_) { session = null }

    if (!Array.isArray(produtos)) produtos = [];

    // Dados de exemplo (se vazio)
    if (!produtos.length) {
      produtos = [
        {id:uuid(), nome:'Jaqueta Jeans', cat:'Jaquetas', tam:'M', cond:'Semi-novo', preco:89.90, qtd:3, img:'https://images.unsplash.com/photo-1516826957135-700dedea698c?q=80&w=600&auto=format&fit=crop'},
        {id:uuid(), nome:'Camisa Listrada', cat:'Camisas', tam:'G', cond:'Usado', preco:39.90, qtd:8, img:'https://images.unsplash.com/photo-1512436991641-6745cdb1723f?q=80&w=600&auto=format&fit=crop'},
        {id:uuid(), nome:'Vestido Floral', cat:'Vestidos', tam:'P', cond:'Novo', preco:119.90, qtd:2, img:'https://images.unsplash.com/photo-1463107971871-fbac9ddb920f?q=80&w=600&auto=format&fit=crop'},
        {id:uuid(), nome:'Saia Midi', cat:'Saias', tam:'M', cond:'Novo', preco:59.90, qtd:5, img:'https://images.unsplash.com/photo-1521572163474-6864f9cf17ab?q=80&w=600&auto=format&fit=crop'},
        {id:uuid(), nome:'Calça Jeans Skinny', cat:'Calças', tam:'40', cond:'Semi-novo', preco:79.90, qtd:7, img:'https://images.unsplash.com/photo-1503342217505-b0a15cf70489?q=80&w=600&auto=format&fit=crop'},
        {id:uuid(), nome:'Tênis Branco', cat:'Calçados', tam:'39', cond:'Usado', preco:99.90, qtd:4, img:'https://images.unsplash.com/photo-1520256862855-398228c41684?q=80&w=600&auto=format&fit=crop'},
        {id:uuid(), nome:'Bolsa de Couro', cat:'Acessórios', tam:'Único', cond:'Novo', preco:149.90, qtd:6, img:'https://images.unsplash.com/photo-1526170375885-4d8ecf77b99f?q=80&w=600&auto=format&fit=crop'},
        {id:uuid(), nome:'Moletom Oversized', cat:'Moletons', tam:'G', cond:'Semi-novo', preco:89.00, qtd:3, img:'https://images.unsplash.com/photo-1541099649105-f69ad21f3246?q=80&w=600&auto=format&fit=crop'},
        {id:uuid(), nome:'Blusa Tricot', cat:'Blusas', tam:'P', cond:'Usado', preco:35.00, qtd:9, img:'https://images.unsplash.com/photo-1512436991641-6745cdb1723f?q=80&w=600&auto=format&fit=crop'},
        {id:uuid(), nome:'Chapéu Fedora', cat:'Acessórios', tam:'Único', cond:'Novo', preco:55.00, qtd:5, img:'https://images.unsplash.com/photo-1460353581641-37baddab0fa2?q=80&w=600&auto=format&fit=crop'}
      ];
      persistProdutos();
    }

    function persistProdutos(){ try { localStorage.setItem(LS_PROD, JSON.stringify(produtos)); } catch(_){} }
    function persistSession(){ try { session ? localStorage.setItem(LS_SESS, JSON.stringify(session)) : localStorage.removeItem(LS_SESS); } catch(_){} }

    function isAdmin(){ return session && session.role === 'admin'; }

    function setRoleLabel(){
      const el = $('#sessionRole');
      if(!session){ el.textContent = 'Sem sessão'; }
      else { el.textContent = ${session.role === 'admin' ? 'Administrador' : 'Pessoa'} • ${session.name || session.email || ''}; }
      // Abas só para admin
      $('#tabEstoque').classList.toggle('hide', !isAdmin());
      $('#tabCadastro').classList.toggle('hide', !isAdmin());
    }

    // ====== Navegação ======
    function showView(id){
      ['#viewAuth','#viewCatalog','#viewEstoque','#viewCadastro'].forEach(sel=> $(sel).classList.add('hide'));
      $(id).classList.remove('hide');
    }
    $('#tabCatalog').onclick = ()=> showView('#viewCatalog');
    $('#tabEstoque').onclick = ()=> isAdmin() ? showView('#viewEstoque') : alert('Apenas administradores.');
    $('#tabCadastro').onclick = ()=> isAdmin() ? showView('#viewCadastro') : alert('Apenas administradores.');
    $('#tabConta').onclick = ()=> showView('#viewAuth');

    // ====== Autenticação ======
    $('#btnLoginPessoa').onclick = ()=>{
      const name = $('#cliNome').value.trim();
      const email = $('#cliEmail').value.trim();
      if(!name || !email) return alert('Preencha nome e e-mail.');
      session = {role:'pessoa', name, email};
      persistSession();
      setRoleLabel();
      showView('#viewCatalog');
    };

    $('#btnLoginAdmin').onclick = ()=>{
      const email = $('#admEmail').value.trim();
      const senha = $('#admSenha').value;
      if(email === 'admin@brecho.com' && senha === '123456'){
        session = {role:'admin', name:'Admin', email};
        persistSession();
        setRoleLabel();
        showView('#viewEstoque');
      } else alert('Credenciais inválidas.');
    };

    // Restaura sessão na carga
    setRoleLabel();
    if(session) showView('#viewCatalog'); else showView('#viewAuth');

    // ====== Catálogo ======
    const catalogList = $('#catalogList');
    const search = $('#search');
    const filtroCond = $('#filtroCond');

    function renderCatalog(){
      const q = (search.value||'').toLowerCase();
      const cond = filtroCond.value;
      const data = produtos.filter(p=>{
        const okQuery = !q || p.nome.toLowerCase().includes(q) || p.cat.toLowerCase().includes(q);
        const okCond = !cond || p.cond === cond;
        return okQuery && okCond;
      });
      catalogList.innerHTML = data.map(p=>`
        <article class="prod-card">
          <img class="thumb" src="${p.img || 'https://images.unsplash.com/photo-1519741497674-611481863552?q=80&w=600&auto=format&fit=crop'}" alt="${p.nome}">
          <div class="prod-body">
            <div class="prod-title">${p.nome}</div>
            <div class="muted" style="margin:4px 0">${p.cat} • Tam. ${p.tam} • ${p.cond}</div>
            <div style="display:flex; align-items:center; justify-content:space-between; gap:8px; margin-top:6px">
              <span class="badge">R$ ${fmt(p.preco)}</span>
              <span class="muted">Qtd: ${p.qtd}</span>
            </div>
            ${isAdmin() ? `<div class="actions" style="margin-top:8px">
              <button class=\"btn ghost\" onclick=\"editProduto('${p.id}')\">Editar</button>
              <button class=\"btn danger\" onclick=\"removeProduto('${p.id}')\">Excluir</button>
            </div>`: ''}
          </div>
        </article>
      `).join('');
    }

    search.oninput = renderCatalog;
    filtroCond.onchange = renderCatalog;

    // ====== Estoque ======
    const estoqueBody = $('#estoqueBody');

    function renderEstoque(){
      let totItens = produtos.length;
      let totUnidades = produtos.reduce((s,p)=> s + Number(p.qtd||0), 0);
      $('#totItens').textContent = totItens;
      $('#totUnidades').textContent = totUnidades;

      estoqueBody.innerHTML = produtos.map(p=>`
        <tr class="${p.qtd<=2 ? 'low' : ''}">
          <td>${p.nome}</td>
          <td>${p.cat}</td>
          <td>${p.tam}</td>
          <td>${p.cond}</td>
          <td>R$ ${fmt(p.preco)}</td>
          <td>
            <input type="number" min="0" value="${p.qtd}" style="width:88px" onchange="updateQtd('${p.id}', this.value)" />
          </td>
          <td>
            <div class="actions">
              <button class="btn ghost" onclick="editProduto('${p.id}')">Editar</button>
              <button class="btn danger" onclick="removeProduto('${p.id}')">Excluir</button>
            </div>
          </td>
        </tr>
      `).join('');
    }

    window.updateQtd = (id, val)=>{
      const p = produtos.find(x=> x.id===id);
      if(!p) return;
      const n = Math.max(0, parseInt(val||0,10));
      p.qtd = n;
      persistProdutos();
      renderCatalog();
      renderEstoque();
    };

    window.removeProduto = (id)=>{
      if(!confirm('Remover este produto?')) return;
      produtos = produtos.filter(p=> p.id !== id);
      persistProdutos();
      renderCatalog();
      renderEstoque();
    };

    window.editProduto = (id)=>{
      if(!isAdmin()) return alert('Apenas administradores.');
      const p = produtos.find(x=> x.id===id);
      if(!p) return;
      $('#pNome').value = p.nome;
      $('#pCat').value = p.cat;
      $('#pTam').value = p.tam;
      $('#pCond').value = p.cond;
      $('#pPreco').value = p.preco;
      $('#pQtd').value = p.qtd;
      $('#pImg').value = p.img || '';
      $('#btnSalvarProduto').dataset.editing = id;
      showView('#viewCadastro');
    };

    // ====== Cadastro ======
    $('#btnLimparForm').onclick = ()=>{
      ['#pNome','#pCat','#pTam','#pPreco','#pQtd','#pImg'].forEach(sel=> $(sel).value='');
      $('#pCond').value='Semi-novo';
      delete $('#btnSalvarProduto').dataset.editing;
    };

    $('#btnSalvarProduto').onclick = ()=>{
      if(!isAdmin()) return alert('Apenas administradores.');
      const nome = $('#pNome').value.trim();
      const cat = $('#pCat').value.trim();
      const tam = $('#pTam').value.trim();
      const cond = $('#pCond').value;
      const preco = parseFloat($('#pPreco').value || '0');
      const qtd = parseInt($('#pQtd').value || '0',10);
      const img = $('#pImg').value.trim();
      if(!nome || !cat || !tam) return alert('Preencha Nome, Categoria e Tamanho.');

      const editingId = $('#btnSalvarProduto').dataset.editing;
      if(editingId){
        const p = produtos.find(x=> x.id===editingId);
        if(p){ Object.assign(p,{nome,cat,tam,cond,preco,qtd,img}); }
      } else {
        produtos.unshift({id:uuid(), nome, cat, tam, cond, preco, qtd, img});
      }
      persistProdutos();
      renderCatalog();
      renderEstoque();
      alert('Produto salvo!');
      $('#btnLimparForm').click();
    };

    // Primeiros renders
    renderCatalog();
    renderEstoque();
  </script>
</body>
</htmlL